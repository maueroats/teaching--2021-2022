<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.101.0" />
<link rel="canonical" type="text/html" href="https://maueroats.github.io/teaching--2021-2022/intermediate-cs/projects/battleship/">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/teaching--2021-2022/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/teaching--2021-2022/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/teaching--2021-2022/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/teaching--2021-2022/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/teaching--2021-2022/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/teaching--2021-2022/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/teaching--2021-2022/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/teaching--2021-2022/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/teaching--2021-2022/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/teaching--2021-2022/favicons/android-192x192.png" sizes="192x192">

<title>Battleship | WY CS</title>
<meta name="description" content="The classic Battleship game, one player version.">
<meta property="og:title" content="Battleship" />
<meta property="og:description" content="The classic Battleship game, one player version." />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://maueroats.github.io/teaching--2021-2022/intermediate-cs/projects/battleship/" />

<meta itemprop="name" content="Battleship">
<meta itemprop="description" content="The classic Battleship game, one player version."><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Battleship"/>
<meta name="twitter:description" content="The classic Battleship game, one player version."/>




<link rel="preload" href="/teaching--2021-2022/scss/main.min.d025e7f93eb7a713039676faaf01ccf911a0435790c00ed7c3e93d0345d088e1.css" as="style">
<link href="/teaching--2021-2022/scss/main.min.d025e7f93eb7a713039676faaf01ccf911a0435790c00ed7c3e93d0345d088e1.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>

  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/teaching--2021-2022/">
		<span class="navbar-logo"></span><span class="font-weight-bold">WY CS</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/teaching--2021-2022/ecs/" ><span>ECS</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link active" href="/teaching--2021-2022/intermediate-cs/" ><span class="active">IntermediateCS</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/teaching--2021-2022/ap-cs/" ><span>AP CS</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/teaching--2021-2022/ai/" ><span>AI</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/teaching--2021-2022/resources/" ><span>Resources</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block"></div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This is the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="/teaching--2021-2022/intermediate-cs/projects/battleship/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Battleship</h1>
<div class="lead">The classic Battleship game, one player version.</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-e417e1576a9cdf76f6fd25fd796c84a3">Battleship Model</a></li>


    
  
    
    
	
<li>2: <a href="#pg-fbf7a5f50b9a32f57c86fdb74ce092f4">Battleship Examples</a></li>


    
  
    
    
	
<li>3: <a href="#pg-80817c971f05e4bdb36fdbe2185dea85">Battleship Outline</a></li>


    
  
    
    
	
<li>4: <a href="#pg-e8dbd0fde048eb472388002c6c7a5e84">Battleship Checks</a></li>


    
  
    
    
	
<li>5: <a href="#pg-717e51c204d39880ed36cd4af2da140b">Battleship Action</a></li>


    
  

    </ul>


<div class="content">
      <p>The game of
<a href="https://en.wikipedia.org/wiki/Battleship_(game)">Battleship</a> is a
classic game from the early 20th Century in which you try to guess the
locations of your opponent&rsquo;s ships in a grid.</p>
<p>You may be able to <a href="https://battleship-game.org/en/">play Battleship
online</a> but do not waste much time
doing that kind of research. Playing on paper is better for developing
your understanding of what information needs to be tracked (the
model).</p>
<ul class="children children-li">
<p><span><li>
<a href="/teaching--2021-2022/intermediate-cs/projects/battleship/model/" >Battleship Model</a></li></p>
<p>Play battleship on paper to develop the model.</p>
</span>
<p><span><li>
<a href="/teaching--2021-2022/intermediate-cs/projects/battleship/examples/" >Battleship Examples</a></li></p>
<p>An example of how to use the model you defined.</p>
</span>
<p><span><li>
<a href="/teaching--2021-2022/intermediate-cs/projects/battleship/outline/" >Battleship Outline</a></li></p>
<p>Game logic, draw handler, mouse handler.</p>
</span>
<p><span><li>
<a href="/teaching--2021-2022/intermediate-cs/projects/battleship/checks/" >Battleship Checks</a></li></p>
<p>Check-expects for the tricker functions in battleship.</p>
</span>
<p><span><li>
<a href="/teaching--2021-2022/intermediate-cs/projects/battleship/draw/" >Battleship Action</a></li></p>
<p>Warm-ups for the draw and mouse handler.</p>
</span>
</ul>

</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e417e1576a9cdf76f6fd25fd796c84a3">1 - Battleship Model</h1>
    <div class="lead">Play battleship on paper to develop the model.</div>
	<p>The process for developing a model is always the same:</p>
<ol>
<li>Background knowledge: understand the rules and decide what you want
your game to look like when you play it. We will play <a href="https://en.wikipedia.org/wiki/File:Battleships_Paper_Game.svg">Battleship on paper</a>.</li>
<li>Draw at least three scenes from different stages of the game. In
this case, you will want more &ndash; include a win screen, a lose
screen, and three others.</li>
<li>List the information necessary to draw the scenes.</li>
<li>Write down the model you will use.</li>
</ol>
<h2 id="step-1-battleship-on-paper">Step 1: Battleship on paper</h2>
<ul>
<li>
<p>Make two 8x8 grids, one for your ships and one for your attacks on the opponent.</p>
</li>
<li>
<p>Number the rows and columns like a computer screen, beginning with
(0,0) in the upper left.</p>
</li>
<li>
<p>Place your ships. Each ship can go either horizontally or vertically. The number and size of ships varies in different versions of the game. Today we will use this list:</p>
<ul>
<li>Aircraft carrier (5 squares)</li>
<li>Battleship (4 squares)</li>
<li>Cruiser (3 squares)</li>
<li>Destroyer (Two, each 2 squares)</li>
<li>Submarine (1 square)</li>
</ul>
</li>
<li>
<p>Play at least ten rounds with a partner. Keep going until at least one ship is sunk.</p>
</li>
</ul>
<h2 id="step-2-develop-the-model">Step 2: Develop the model</h2>
<p>For developing the model we will think about only two ships. Later you can add the rest.</p>
<ul>
<li>Draw five different situations, including a win and lose end game.</li>
<li>List information you need to draw those situations.</li>
<li>Discuss what information must be <em>remembered</em> (the &ldquo;independent variables&rdquo;) and what can be <em>computed</em> (the &ldquo;dependent variables&rdquo;).</li>
<li>Write the model that corresponds to each one of your scenes.</li>
<li>Save this paper! Check in your work and don&rsquo;t lose it.</li>
</ul>
<h2 id="step-3-check-your-model">Step 3: Check your model</h2>
<ul>
<li>How do you represent one ship?</li>
<li>How do you represent one shot fired?</li>
</ul>
<h2 id="interesting-variations">Interesting variations</h2>
<p>You can explore these ideas later in your game.</p>
<ul>
<li>Some games allow you to shoot multiple times in one turn: one shot
for each un-sunk ship you have.</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-fbf7a5f50b9a32f57c86fdb74ce092f4">2 - Battleship Examples</h1>
    <div class="lead">An example of how to use the model you defined.</div>
	<p>In order for all of us to be working with a similar model, this page
uses the definitions below for <code>ship</code> and <code>game</code>.</p>
<pre><code>    (define-struct ship (name posns))
    (define-struct game (ships shots))
</code></pre>
<p>How do we represent one ship, a &ldquo;Destroyer&rdquo; that is three squares long?</p>
<pre><code>    (define ex-ship 
            (make-ship &quot;Destroyer&quot; 
                       (list (make-posn 5 1) (make-posn 5 2) (make-posn 5 3))))
</code></pre>
<p>How can we represent a game in which two shots have been fired?</p>
<pre><code>    (define ex-shots (list (make-posn 5 0)
                           (make-posn 5 1)))
    (define ex-game 
            (make-game (list ex-ship)
                       shots))
</code></pre>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-80817c971f05e4bdb36fdbe2185dea85">3 - Battleship Outline</h1>
    <div class="lead">Game logic, draw handler, mouse handler.</div>
	<p>In order for all of us to be working with a similar model, this page
uses the definitions below for <code>ship</code> and <code>game</code>.</p>
<pre><code>    (define-struct ship (name posns))
    (define-struct game (ships shots))
</code></pre>
<h2 id="game-logic">Game logic</h2>
<ul>
<li>
<p><code>posn-in-list</code>: posn(x) list-of-posns(data) -&gt; boolean. True if x is
one of the posns in data. You may have to write the <code>posn=?</code>
function yourself if it is not in your <code>posn-util</code>.</p>
</li>
<li>
<p><code>shot-hit-ship-ps?</code>: posn(shot) list-of-posns(ps) -&gt; boolean. True if
the shot hit the ship specified by the posns.</p>
</li>
<li>
<p><code>shot-hit-any-ship?</code>: posn(shot) list-of-ships -&gt; boolean. True if
the shot hits any one of the ships.</p>
</li>
<li>
<p><code>ship-ps-sunk?</code>: list-of-posn(ship-ps) list-of-posn(shots) -&gt;
boolean. True if every posn in the ship is hit by a shot. (Helper
function.)</p>
</li>
</ul>
<p>Functions that use the ship struct instead of a list of posns make
the logic look nice (but are not strictly necessary).</p>
<ul>
<li><code>shot-hit-ship?</code>: posn(shot) ship-struct -&gt; boolean</li>
<li><code>ship-sunk?</code>: ship-struct list-of-posn(shots) -&gt; boolean</li>
</ul>
<h2 id="drawing">Drawing</h2>
<ul>
<li>You should have constants defined for the width and height of the board.
Call them <code>COLUMNS</code> and <code>ROWS</code>.</li>
</ul>
<p>There are two different, equally valid, ways to draw:</p>
<ol>
<li>Draw the grid, filling in the correct coloring for each square as you go.</li>
<li>Draw an empty grid, then fill in each shot using <code>place-image</code>.</li>
</ol>
<p>This discussion will use the second method.</p>
<h3 id="sizes">Sizes</h3>
<p>How big should each grid square be? You get to decide, but make a
constant instead of just writing &ldquo;40&rdquo; or &ldquo;50&rdquo; everywhere in your code.</p>
<h3 id="draw-grid">Draw grid</h3>
<p>Hopefully you&rsquo;ve done this before. Usually two functions combine to make a grid.</p>
<ol>
<li>
<p><code>horizontal-stack</code>: number(m) image -&gt; image. Repeat the image
(which will be a grid square) M times.</p>
</li>
<li>
<p><code>vertical-stack</code>: number(n) image -&gt; image. Repeat the image (which
will be a row of squares) N times.</p>
</li>
</ol>
<h3 id="grid-coordinates">Grid coordinates</h3>
<p>When we talk about the square at grid coordinates (0,2), we mean row 0
(the top row) and column 2 (which is the third column, since we start
counting from zero).</p>
<p>Image coordinates are usually numbers like (20,100), representing the
actual location in the image of the center of the grid square.</p>
<h3 id="draw-shots">Draw shots</h3>
<p>Drawing the shots means we have to translate from grid coordinates to image coordinates.</p>
<p>When each square is 40x40, what are the coordinates of the center of grid square (2,1)?
Draw a picture and figure it out now!</p>
<ul>
<li>
<p><code>grid-&gt;image-coords</code>: posn -&gt; posn. Translate the grid coordinates
to image coordinates. The result should depend on the size of the squares in the grid.</p>
</li>
<li>
<p><code>draw-one-shot</code>: game posn(shot) image(bg) -&gt; image. Draw one shot
on the background. You will need to decide if the shot is a hit or
a miss before you draw it.</p>
</li>
<li>
<p><code>draw-all-shots</code>: game list-of-posn(shots) image(bg) -&gt; image. Draw
all shots on the background.</p>
</li>
</ul>
<h2 id="mouse-handler">Mouse handler</h2>
<p>When you click on a square, it should make a &ldquo;shot&rdquo; that hits that square.</p>
<p>Example: grid squares are huge, 100x100. You click on (310, 190). What
board square contains that click?</p>
<p>Answer: (3,1). Just divide each coordinate by the size of one grid square.</p>
<ul>
<li>
<p>Signature: <code>mouse-handler</code>: game(old-model) x y event -&gt; game(new-model).</p>
</li>
<li>
<p>Purpose: when the event is a click, add the corresponding square to
the list of shots in the model.</p>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-e8dbd0fde048eb472388002c6c7a5e84">4 - Battleship Checks</h1>
    <div class="lead">Check-expects for the tricker functions in battleship.</div>
	<p>The ability to write checks independently is important! These checks
are written to help people know when they are off track, but if you
are doing top-level work, you should be analyzing and writing your own
functions (including checks). Check in here when you think your
function works.</p>
<h2 id="basic-definitions">Basic definitions</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-racket" data-lang="racket"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">define-struct</span> <span style="color:#000">ship</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">name</span> <span style="color:#000">posns</span><span style="color:#000;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">define</span> <span style="color:#000">ex-ship-1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-ship</span> <span style="color:#4e9a06">&#34;Betty&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">list</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-posn</span> <span style="color:#0000cf;font-weight:bold">5</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>                   <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-posn</span> <span style="color:#0000cf;font-weight:bold">5</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">))))</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">define</span> <span style="color:#000">ex-ship-2</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-ship</span> <span style="color:#4e9a06">&#34;Charlie&#34;</span>
</span></span><span style="display:flex;"><span>             <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">list</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-posn</span> <span style="color:#0000cf;font-weight:bold">3</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">))))</span>
</span></span></code></pre></div><h2 id="shot-hit-any-ship">shot-hit-any-ship?</h2>
<p>A shot is colored a &ldquo;hit&rdquo; if it hits any ship on the board. The only
way to know a shot is a &ldquo;miss&rdquo; is by checking that it misses every
ship. Any ship you do not check could be placed at the spot where the
shot hits.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-racket" data-lang="racket"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">;; one ship, one shot, shot hits ship</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">check-expect</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">shot-hit-any-ship?</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-posn</span> <span style="color:#0000cf;font-weight:bold">5</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>                                  <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">list</span> <span style="color:#000">ex-ship-1</span><span style="color:#000;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87">true</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">;; one ship, one shot, shot misses ship</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">check-expect</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">shot-hit-any-ship?</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-posn</span> <span style="color:#0000cf;font-weight:bold">5</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>                                  <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">list</span> <span style="color:#000">ex-ship-1</span><span style="color:#000;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">false</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">;; two ship, one shot, shot hits ship #2</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">check-expect</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">shot-hit-any-ship?</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-posn</span> <span style="color:#0000cf;font-weight:bold">3</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>                                  <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">list</span> <span style="color:#000">ex-ship-1</span>
</span></span><span style="display:flex;"><span>                                        <span style="color:#000">ex-ship-2</span><span style="color:#000;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87">true</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">;; two ship, one shot, shot misses everything</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">check-expect</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">shot-hit-any-ship?</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-posn</span> <span style="color:#0000cf;font-weight:bold">9</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>                                  <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">list</span> <span style="color:#000">ex-ship-1</span>
</span></span><span style="display:flex;"><span>                                        <span style="color:#000">ex-ship-2</span><span style="color:#000;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">false</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><h2 id="ship-sunk">ship-sunk?</h2>



<div class="alert alert-primary" role="alert">
<h4 class="alert-heading">warning</h4>

    A very common mistake is to declare a ship sunk once
it is hit by a single shot.

</div>

<p>This discussion will use a helper function. It is not absolutely
necessary to write your functions this way.</p>
<pre tabindex="0"><code>ship-sunk? : ship list-of-posn(shots) -&gt; boolean
ship-sunk-helper? : list-of-posn(ship-posns)
                    list-of-posn(shots)
                    -&gt; boolean
</code></pre><p>Checks for the helper:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-racket" data-lang="racket"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">;; one shot, and it sinks the ship</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">check-expect</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">ship-sunk-helper?</span>
</span></span><span style="display:flex;"><span>               <span style="color:#000;font-weight:bold">(</span><span style="color:#000">ship-posns</span> <span style="color:#000">ex-ship-2</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>               <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">list</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-posn</span> <span style="color:#0000cf;font-weight:bold">3</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">)))</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87">true</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">;; one shot, and it misses the ship</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">check-expect</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">ship-sunk-helper?</span>
</span></span><span style="display:flex;"><span>               <span style="color:#000;font-weight:bold">(</span><span style="color:#000">ship-posns</span> <span style="color:#000">ex-ship-2</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>               <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">list</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-posn</span> <span style="color:#0000cf;font-weight:bold">4</span> <span style="color:#0000cf;font-weight:bold">5</span><span style="color:#000;font-weight:bold">)))</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">false</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">;; two shots, and first misses, second sinks</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">check-expect</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">ship-sunk-helper?</span>
</span></span><span style="display:flex;"><span>               <span style="color:#000;font-weight:bold">(</span><span style="color:#000">ship-posns</span> <span style="color:#000">ex-ship-2</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>               <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">list</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-posn</span> <span style="color:#0000cf;font-weight:bold">3</span> <span style="color:#0000cf;font-weight:bold">8</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>                     <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-posn</span> <span style="color:#0000cf;font-weight:bold">3</span> <span style="color:#0000cf;font-weight:bold">4</span><span style="color:#000;font-weight:bold">)))</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87">true</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">;; one shot hits, but ship has 2 posns, not sunk</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">check-expect</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">ship-sunk-helper?</span>
</span></span><span style="display:flex;"><span>               <span style="color:#000;font-weight:bold">(</span><span style="color:#000">ship-posns</span> <span style="color:#000">ex-ship-1</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>               <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">list</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-posn</span> <span style="color:#0000cf;font-weight:bold">5</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)))</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87;font-weight:bold">false</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span> <span style="color:#8f5902;font-style:italic">;; two shots hits, sunk</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">check-expect</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">ship-sunk-helper?</span>
</span></span><span style="display:flex;"><span>               <span style="color:#000;font-weight:bold">(</span><span style="color:#000">ship-posns</span> <span style="color:#000">ex-ship-1</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>               <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">list</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-posn</span> <span style="color:#0000cf;font-weight:bold">5</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>                     <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-posn</span> <span style="color:#0000cf;font-weight:bold">5</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)))</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87">true</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span> <span style="color:#8f5902;font-style:italic">;; two shots hits, sunk</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">check-expect</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">ship-sunk-helper?</span>
</span></span><span style="display:flex;"><span>               <span style="color:#000;font-weight:bold">(</span><span style="color:#000">ship-posns</span> <span style="color:#000">ex-ship-1</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>               <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">list</span>  <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-posn</span> <span style="color:#0000cf;font-weight:bold">5</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>                      <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-posn</span> <span style="color:#0000cf;font-weight:bold">5</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)))</span>
</span></span><span style="display:flex;"><span>              <span style="color:#204a87">true</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><p>This function can be written by going through either the list of posns
in the ship or the shots. I prefer to start with the question &ldquo;is the
first posn in the ship hit by a shot?&rdquo;</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-717e51c204d39880ed36cd4af2da140b">5 - Battleship Action</h1>
    <div class="lead">Warm-ups for the draw and mouse handler.</div>
	<h2 id="grid-drawing-system">Grid Drawing System</h2>
<p>We are going to set up a system to draw on a grid where each square is
50x50. You have probably done this before.</p>
<p>We want to take the list</p>
<pre><code>(list (make-posn 5 2) (make-posn 4 3) (make-posn 3 2))
</code></pre>
<p>and draw it as</p>
<figure>
    <img src="/teaching--2021-2022/intermediate-cs/projects/battleship/draw/greysquares.png" width="150px"/> 
</figure>
<p>Ingredients:</p>
<ul>
<li>
<p><code>gp-&gt;cp</code>: posn -&gt; posn. A function that takes grid coordinates and
puts out the computer coordinates of the center of the grid
square. You need to decide if the upper left is <code>(0,0)</code> or
<code>(1,1)</code> (both are fine). I chose <code>(0,0)</code> as the upper left, which
corresponds to a computer posn of <code>(25,25)</code>.</p>
<pre><code>  (check-expect (gp-&gt;cp (make-posn 1 2)) (make-posn 75 125))
</code></pre>
</li>
<li>
<p><code>draw-squares</code>: list-of-posn(grid-posns) image(background) -&gt; image. Draw grey squares at
every grid posn, on top of the background image.</p>
<p>The purpose of taking in an image background is to make it easier to
make this function step by step. You can also use smaller
backgrounds for your testing than you want to use for the real game.</p>
</li>
<li>
<p><code>draw-h</code>: list-of-posn(grid-posns) -&gt; image. Same as <code>draw-squares</code>,
but pick a specific background.</p>
</li>
</ul>
<h2 id="interactive-clicking">Interactive Clicking</h2>
<p>Now we want to place a grey square every time we click inside the grid
box. The center of the square we place should be in the center of the
grid square, regardless of whether we click in the middle or on the
edge of the grid square.</p>
<p>Ingredients:</p>
<ul>
<li>
<p><code>cp-&gt;gp</code>: posn -&gt; posn. A function to translate computer coordinates
to grid coordinates. I am using <code>(0,0)</code> as the upper left:</p>
<pre><code>  (check-expect (cp-&gt;gp (make-posn 28 107) (make-posn 0 2)))
</code></pre>
</li>
<li>
<p><code>mouse-h</code>: A mouse handler using a list of posns for the model. Add
the grid posn when you click.</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-racket" data-lang="racket"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">check-expect</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">mouse-h</span> <span style="color:#204a87">empty</span> <span style="color:#0000cf;font-weight:bold">28</span> <span style="color:#0000cf;font-weight:bold">107</span> <span style="color:#4e9a06">&#34;button-down&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>              <span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">list</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">make-posn</span> <span style="color:#0000cf;font-weight:bold">0</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)))</span>
</span></span></code></pre></div><h2 id="combining">Combining</h2>
<p>Put your functions together and make sure they work before you try to
do something more complex.</p>
<pre tabindex="0"><code>(big-bang empty
  (on-draw draw-h)
  (on-mouse mouse-h))
</code></pre><p>Make sure the grid square lights up no matter where in the square you
click.</p>
<h2 id="bonus">Bonus</h2>
<p>Add a key handler so that hitting backspace (key is <code>&quot;\b&quot;</code>) removes
the most recently placed square.</p>

</div>



    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Racket Docs" aria-label="Racket Docs">
    <a class="text-white" target="_blank" rel="noopener" href="https://docs.racket-lang.org/" aria-label="Racket Docs">
      <i class="fab fa-galactic-republic"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Picturing Programs" aria-label="Picturing Programs">
    <a class="text-white" target="_blank" rel="noopener" href="https://picturingprograms.com" aria-label="Picturing Programs">
      <i class="fas fa-book"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Python 3 Docs" aria-label="Python 3 Docs">
    <a class="text-white" target="_blank" rel="noopener" href="https://docs.python.org/3/tutorial/index.html" aria-label="Python 3 Docs">
      <i class="fab fa-python"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Lean You a Haskell" aria-label="Lean You a Haskell">
    <a class="text-white" target="_blank" rel="noopener" href="https://learnyouahaskell.com/" aria-label="Lean You a Haskell">
      <i class="fas fa-brain"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2022 Andrew Mauer-Oats All Rights Reserved</small>
        
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
    integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js"
    integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA=="
    crossorigin="anonymous"></script>





<script src='/js/tabpane-persist.js'></script>


















<script src="/teaching--2021-2022/js/main.min.f76dedb82c2626dc505c0e8ab40cba7bbff47cf7e1d72b235baecccdce24f3c7.js" integrity="sha256-923tuCwmJtxQXA6KtAy6e7/0fPfh1ysjW67Mzc4k88c=" crossorigin="anonymous"></script>




  </body>
</html>
